"0",""
"0","my_indicator = 47"
"0","my_location  = 32"
"0","my_startyr   = 1980"
"0","my_endyr     = 2020"
"0",""
"0","target = paste0(base_url,"
"0","                '/data/indicators/',my_indicator,"
"0","                '/locations/',my_location,"
"0","                '/start/',my_startyr,"
"0","                '/end/',my_endyr,"
"0","                '/?format=csv')"
"0",""
"0","target"
"1","[1]"
"1"," ""https://population.un.org/dataportalapi/api/v1/data/indicators/47/locations/32/start/1980/end/2020/?format=csv"""
"1","
"
"0","df_data = read.csv(target, sep='|', skip=1)"
"0",""
"0","# the ""AgeLabel"" variable for this indicator has character values 0,1,2,...,99,100+"
"0","# convert to integers"
"0",""
"0","AgeLabel_vals = c(as.character(0:99), '100+')"
"0","age_vals      = 0:100"
"0","names(age_vals) = AgeLabel_vals"
"0",""
"0","df_data = df_data %>% "
"0","            mutate(Age = age_vals[AgeLabel])"
"0",""
"0","# look at the data's structure"
"0",""
"0","dim(df_data)"
"1","[1]"
"1"," 12423"
"1","    33"
"1","
"
"0","names(df_data)"
"1"," [1]"
"1"," ""LocationId""          "
"1"," ""Location""            "
"1"," ""Iso3""                "
"1","
"
"1"," [4]"
"1"," ""Iso2""                "
"1"," ""LocationTypeId""      "
"1"," ""IndicatorId""         "
"1","
"
"1"," [7]"
"1"," ""Indicator""           "
"1"," ""IndicatorDisplayName"""
"1"," ""SourceId""            "
"1","
"
"1","[10]"
"1"," ""Source""              "
"1"," ""Revision""            "
"1"," ""VariantId""           "
"1","
"
"1","[13]"
"1"," ""Variant""             "
"1"," ""VariantShortName""    "
"1"," ""VariantLabel""        "
"1","
"
"1","[16]"
"1"," ""TimeId""              "
"1"," ""TimeLabel""           "
"1"," ""TimeMid""             "
"1","
"
"1","[19]"
"1"," ""CategoryId""          "
"1"," ""Category""            "
"1"," ""EstimateTypeId""      "
"1","
"
"1","[22]"
"1"," ""EstimateType""        "
"1"," ""EstimateMethodId""    "
"1"," ""EstimateMethod""      "
"1","
"
"1","[25]"
"1"," ""SexId""               "
"1"," ""Sex""                 "
"1"," ""AgeId""               "
"1","
"
"1","[28]"
"1"," ""AgeLabel""            "
"1"," ""AgeStart""            "
"1"," ""AgeEnd""              "
"1","
"
"1","[31]"
"1"," ""AgeMid""              "
"1"," ""Value""               "
"1"," ""Age""                 "
"1","
"
"0","# peek at a random bit of the dataframe"
"0",""
"0","df_data %>% "
"0","  sample_n(size=20) %>% "
"0","  select(Location, starts_with('Age'), starts_with('Time'), Value) %>% "
"0","  as_tibble()"
